<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="Liam Orga">
<meta name="theme-color" content="#ffffff">
<title>Liam Orga</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üë∂</text></svg>">
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html,body,#root{height:100%;width:100%;overflow:hidden}
body{font-family:'DM Sans',-apple-system,sans-serif;background:#F8FAFC;-webkit-font-smoothing:antialiased;-webkit-tap-highlight-color:transparent}
input,button,select,textarea{font-family:inherit}button{cursor:pointer;-webkit-appearance:none}input:focus,textarea:focus,select:focus{outline:none}
.app{max-width:480px;margin:0 auto;height:100dvh;display:flex;flex-direction:column;background:#F8FAFC}
.hdr{display:flex;justify-content:space-between;align-items:center;padding:12px 16px 8px;background:#fff;border-bottom:1px solid #E5E7EB;flex-shrink:0}
.hdr-l{display:flex;align-items:center;gap:8px}.hdr-e{font-size:22px}.hdr-t{font-size:16px;font-weight:800;color:#1E293B}.hdr-d{font-size:10px;color:#94A3B8}
.hdr-r{display:flex;align-items:center;gap:6px}.hdr-s{font-size:12px;font-weight:700;color:#2563EB;background:#EFF6FF;padding:4px 8px;border-radius:16px}
.sdot{width:7px;height:7px;border-radius:4px}.sdot.on{background:#059669}.sdot.off{background:#EF4444}
.cnt{flex:1;overflow-y:auto;overflow-x:hidden;padding-bottom:68px;-webkit-overflow-scrolling:touch}.vp{padding:12px 14px 20px}
.ob{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100dvh;padding:28px 24px;background:linear-gradient(150deg,#EFF6FF,#FFF1F5 50%,#FFFBEB)}
.ob-l{font-size:56px}.ob-t{font-size:30px;font-weight:800;color:#1E293B}.ob-s{font-size:14px;color:#64748B;margin:2px 0 24px}
.ob-c{background:#fff;border-radius:14px;padding:16px 20px;width:100%;max-width:300px;box-shadow:0 2px 10px rgba(0,0,0,.05);margin-bottom:14px}
.ob-r{display:flex;align-items:center;gap:10px}.ob-r+.ob-r{margin-top:12px}.ob-i{font-size:24px}.ob-lb{font-size:13px;font-weight:700;color:#1E293B}.ob-tm{font-size:12px;color:#64748B}
.ob-inf{background:#EEF2FF;border-radius:10px;padding:12px 16px;width:100%;max-width:300px;margin-bottom:14px;border:1px solid #C7D2FE;font-size:12px;line-height:1.5;color:#4338CA}
.ob-ns{width:100%;max-width:300px;margin-bottom:20px;text-align:center}.ob-nl{font-size:13px;font-weight:600;color:#1E293B;margin-bottom:6px}.ob-nb{display:flex;gap:8px}
.ob-nbtn{flex:1;padding:12px 0;border-radius:10px;border:2px solid;font-size:15px;font-weight:700}
.ob-go{background:#1E293B;color:#fff;border:none;border-radius:12px;padding:12px 40px;font-size:15px;font-weight:700}.ob-go:disabled{opacity:.4}
.days{display:flex;gap:4px;margin-bottom:12px;overflow-x:auto;padding:2px 0}
.day-btn{min-width:44px;padding:8px 4px;border-radius:10px;border:none;background:#fff;display:flex;flex-direction:column;align-items:center;gap:2px;box-shadow:0 1px 2px rgba(0,0,0,.03);flex-shrink:0}
.day-btn.active{background:#2563EB;box-shadow:0 2px 8px rgba(37,99,235,.3)}
.day-btn .dn{font-size:10px;font-weight:600;color:#94A3B8}.day-btn.active .dn{color:rgba(255,255,255,.8)}
.day-btn .dnum{font-size:16px;font-weight:800;color:#1E293B}.day-btn.active .dnum{color:#fff}
.day-btn.td{border:2px solid #2563EB}
.sbar{display:flex;align-items:center;justify-content:center;gap:5px;background:#1E293B;border-radius:8px;padding:6px 8px;margin-bottom:12px}
.sbar span{font-size:10px;color:#CBD5E1;font-weight:500}.sbar .ar{color:#475569}
.tsec{margin-bottom:14px}.tsec-h{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
.tsec-t{font-size:13px;font-weight:700;color:#1E293B;display:flex;align-items:center;gap:6px}
.tsec-c{font-size:11px;font-weight:600}.tsec-c.done{color:#059669}.tsec-c.pending{color:#94A3B8}
.tc{background:#fff;border-radius:10px;padding:10px 12px;margin-bottom:5px;box-shadow:0 1px 2px rgba(0,0,0,.02)}.tc.done{opacity:.45}
.tc-r{display:flex;align-items:flex-start;gap:8px}
.ck{width:24px;height:24px;min-width:24px;border-radius:7px;border:2px solid #CBD5E1;background:#fff;display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:700;color:transparent}.ck.on{background:#059669;border-color:#059669;color:#fff}
.tc-c{flex:1;min-width:0}.tc-t{font-size:13px;font-weight:500;color:#1E293B;line-height:1.3}
.tc-m{display:flex;gap:3px;margin-top:4px;flex-wrap:wrap;align-items:center}
.bg{border-radius:4px;font-weight:600;padding:1px 5px;white-space:nowrap;font-size:9px;display:inline-block}
.tc-ob{padding:2px 8px;border-radius:6px;border:1.5px solid;font-size:11px;font-weight:600;flex-shrink:0;margin-left:auto}
.pr{display:flex;align-items:center;gap:5px}.pr-bg{flex:1;height:4px;background:#E5E7EB;border-radius:2px;overflow:hidden}.pr-bg.h5{height:5px;border-radius:3px}.pr-bg.h3{height:3px}.pr-f{height:100%;border-radius:inherit;transition:width .4s}.pr-t{font-size:9px;font-weight:700;color:#94A3B8;min-width:24px;text-align:right}
.gc{background:#fff;border-radius:14px;padding:16px;margin-bottom:12px;box-shadow:0 1px 4px rgba(0,0,0,.04)}.gc-t{font-size:20px;font-weight:800;color:#1E293B}.gc-s{font-size:12px;color:#64748B;margin:3px 0 8px}
.mlc{background:#fff;border-radius:12px;padding:14px 16px;margin-bottom:14px;box-shadow:0 1px 3px rgba(0,0,0,.03)}.ml-t{font-size:13px;font-weight:700;color:#1E293B;margin-bottom:8px}
.ml-s{display:flex;gap:6px}.ml-si{flex:1;text-align:center}.ml-n{font-size:18px;font-weight:800}.ml-l{font-size:9px;color:#94A3B8;font-weight:600}
.cg{display:grid;grid-template-columns:1fr 1fr;gap:6px}
.cb{background:#fff;border-radius:10px;padding:12px 10px;text-align:left;border:none;box-shadow:0 1px 2px rgba(0,0,0,.03);font-family:inherit;border-top:3px solid}
.cb-i{font-size:20px}.cb-t{font-size:11px;font-weight:700;color:#1E293B;margin-top:3px}.cb-c{font-size:10px;color:#94A3B8;font-weight:600;margin:2px 0 5px}
.bk{border:none;background:none;font-size:13px;font-weight:600;color:#2563EB;padding:2px 0;margin-bottom:8px}
.ch{display:flex;align-items:center;gap:10px;background:#fff;border-radius:12px;padding:14px 16px;margin-bottom:14px;box-shadow:0 1px 2px rgba(0,0,0,.03);border-left:4px solid}
.fh{display:flex;align-items:center;gap:6px;padding:10px 0 4px;font-size:12px;font-weight:700;color:#64748B}
.fd{width:7px;height:7px;border-radius:4px}
.ptabs{display:flex;gap:6px;margin-bottom:14px}
.ptab{flex:1;padding:10px 0;border-radius:10px;border:2px solid;font-size:14px;font-weight:700}
.pch{display:flex;align-items:center;gap:5px;padding:12px 0 4px;font-size:12px;font-weight:700}.pcc{font-size:10px;color:#94A3B8;font-weight:600;margin-left:auto}
.ccb{display:flex;align-items:center;gap:8px;width:100%;padding:12px 14px;border-radius:10px;border:none;background:#fff;margin-bottom:5px;box-shadow:0 1px 2px rgba(0,0,0,.02);font-family:inherit;text-align:left}
.ccb:active{background:#F8FAFC}.ccb .cci{font-size:18px}.ccb .cct{flex:1;font-size:13px;font-weight:600;color:#1E293B}.ccb .ccn{font-size:11px;color:#94A3B8}
.ubg{background:#EF4444;color:#fff;font-size:9px;font-weight:700;min-width:16px;height:16px;border-radius:8px;display:flex;align-items:center;justify-content:center;padding:0 4px}
.ctb{display:flex;align-items:center;gap:8px;width:100%;padding:10px 12px;border-radius:8px;border:none;background:#fff;margin-bottom:4px;box-shadow:0 1px 1px rgba(0,0,0,.02);font-family:inherit;text-align:left}
.ctb:active{background:#F9FAFB}.ctb .ctt{flex:1;font-size:13px;font-weight:500;color:#1E293B}
.ctb .ctl{font-size:11px;color:#94A3B8;max-width:110px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.udot{width:6px;height:6px;border-radius:3px;background:#EF4444;flex-shrink:0}
.th{padding:10px 14px;border-bottom:1px solid #E5E7EB;background:#fff;display:flex;align-items:center;gap:8px}
.th-bk{border:none;background:none;font-size:18px;color:#2563EB;padding:4px}
.th-t{flex:1;font-size:13px;font-weight:700;color:#1E293B}.th-s{font-size:10px;color:#94A3B8}
.tmsgs{flex:1;overflow-y:auto;padding:8px 14px}
.mb{padding:8px 12px;border-radius:14px;margin-top:6px;max-width:82%;font-size:13px;line-height:1.35}
.mb.mine{background:#2563EB;color:#fff;margin-left:auto;border-bottom-right-radius:4px}
.mb.theirs{background:#F1F5F9;color:#1E293B;margin-right:auto;border-bottom-left-radius:4px}
.mb .mbi{font-size:9px;margin-top:2px;opacity:.6}
.mib{display:flex;gap:6px;padding:10px 14px;background:#fff;border-top:1px solid #F1F5F9}
.mib input{flex:1;font-size:14px;padding:10px 14px;border-radius:20px;border:1px solid #E5E7EB}
.mib button{background:#2563EB;color:#fff;border:none;border-radius:20px;width:40px;height:40px;font-size:16px;font-weight:700}
.lh{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
.lt{font-size:15px;font-weight:700;color:#1E293B}
.la{background:#2563EB;color:#fff;border:none;border-radius:8px;padding:7px 12px;font-size:12px;font-weight:700}
.ls{width:100%;padding:9px 12px;border-radius:8px;border:1px solid #E5E7EB;font-size:13px;margin-bottom:10px;background:#fff}
.li{background:#fff;border-radius:8px;padding:10px 12px;margin-bottom:4px;box-shadow:0 1px 1px rgba(0,0,0,.02);display:flex;align-items:center;gap:8px}
.li-c{flex:1;min-width:0}.li-t{font-size:13px;font-weight:500;color:#1E293B}.li-m{font-size:10px;color:#94A3B8;margin-top:2px}
.li-a{display:flex;gap:4px}
.lib{width:30px;height:30px;border-radius:7px;border:1px solid #E5E7EB;background:#fff;display:flex;align-items:center;justify-content:center;font-size:13px}
.libd{border-color:#FEE2E2;background:#FEF2F2}
.cel{text-align:center;padding:14px;background:linear-gradient(135deg,#F0FDF4,#ECFDF5);border-radius:12px;margin-bottom:10px}.cel-e{font-size:32px}.cel-t{font-size:13px;font-weight:700;color:#059669;margin-top:2px}
.cic{background:#fff;border-radius:14px;padding:18px 16px;box-shadow:0 2px 6px rgba(0,0,0,.04)}.ci-t{font-size:17px;font-weight:800;color:#1E293B;margin-bottom:3px}.ci-s{font-size:12px;color:#64748B;margin-bottom:14px}
.ci-q{display:flex;gap:8px;align-items:flex-start;padding:8px 0;border-bottom:1px solid #F1F5F9}.ci-q:last-of-type{border-bottom:none}
.ci-n{width:22px;height:22px;min-width:22px;border-radius:6px;background:#EEF2FF;color:#4338CA;font-size:11px;font-weight:700;display:flex;align-items:center;justify-content:center}
.ci-tx{font-size:13px;color:#1E293B;line-height:1.4;font-weight:500}
.tb{margin-top:12px;padding:12px 14px;border-radius:10px;border:1px solid}.tb.y{background:#FFFBEB;border-color:#FDE68A}.tb.g{background:#F0FDF4;border-color:#BBF7D0}
.tbt{font-size:13px;font-weight:700;margin-bottom:3px}.tbx{font-size:12px;line-height:1.4}.tb.y .tbt,.tb.y .tbx{color:#92400E}.tb.g .tbt,.tb.g .tbx{color:#166534}
.mo{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.4);z-index:200;display:flex;align-items:flex-end;justify-content:center}
.md{background:#fff;border-radius:18px 18px 0 0;width:100%;max-width:480px;max-height:82vh;overflow-y:auto;padding:20px 18px 28px;animation:su .2s ease}
@keyframes su{from{transform:translateY(100%)}to{transform:translateY(0)}}
.md-t{font-size:16px;font-weight:800;color:#1E293B;margin-bottom:14px;display:flex;justify-content:space-between;align-items:center}
.md-x{width:30px;height:30px;border-radius:7px;border:1px solid #E5E7EB;background:#fff;display:flex;align-items:center;justify-content:center;font-size:14px}
.fg{margin-bottom:12px}.fl{font-size:11px;font-weight:700;color:#64748B;margin-bottom:3px;display:block}
.fi{width:100%;padding:9px 11px;border-radius:8px;border:1px solid #E5E7EB;font-size:13px;background:#fff}
.fta{width:100%;padding:9px 11px;border-radius:8px;border:1px solid #E5E7EB;font-size:13px;min-height:50px;resize:vertical;background:#fff}
.fse{width:100%;padding:9px 11px;border-radius:8px;border:1px solid #E5E7EB;font-size:13px;background:#fff}
.fr{display:flex;gap:6px}
.fsub{width:100%;padding:12px;border-radius:10px;border:none;background:#1E293B;color:#fff;font-size:14px;font-weight:700;margin-top:6px}
.fdel{width:100%;padding:10px;border-radius:10px;border:1px solid #FEE2E2;background:#FEF2F2;color:#DC2626;font-size:13px;font-weight:600;margin-top:6px}
.asc{display:flex;flex-direction:column;gap:6px;margin-bottom:14px}
.asb{padding:10px 14px;border-radius:10px;border:1.5px solid #E5E7EB;background:#fff;font-size:13px;font-weight:600;color:#1E293B;text-align:left;display:flex;align-items:center;justify-content:space-between}
.asb.sel{border-color:#2563EB;background:#EFF6FF;color:#2563EB}.ash{font-size:11px;color:#94A3B8;font-weight:400}
.asp{display:flex;gap:8px;margin-bottom:14px}
.aspp{flex:1;padding:14px 0;border-radius:10px;border:2px solid #E5E7EB;font-size:14px;font-weight:700;text-align:center}
.assv{width:100%;padding:12px;border-radius:10px;border:none;background:#1E293B;color:#fff;font-size:14px;font-weight:700}
.nav{position:fixed;bottom:0;left:50%;transform:translateX(-50%);width:100%;max-width:480px;display:flex;background:#fff;border-top:1px solid #E5E7EB;padding:3px 4px;padding-bottom:max(4px,env(safe-area-inset-bottom));z-index:100}
.nb{flex:1;display:flex;flex-direction:column;align-items:center;gap:0;padding:6px 0;border:none;background:none;border-radius:8px;position:relative}.nb.act{background:#EFF6FF}
.ni{font-size:17px}.nl{font-size:9px;font-weight:500;color:#94A3B8}.nb.act .nl{font-weight:700;color:#2563EB}
.nbg{position:absolute;top:1px;right:calc(50% - 16px);background:#EF4444;color:#fff;font-size:8px;font-weight:700;min-width:14px;height:14px;border-radius:7px;display:flex;align-items:center;justify-content:center;padding:0 3px}
.ld{display:flex;align-items:center;justify-content:center;min-height:100vh;font-size:16px;color:#64748B;flex-direction:column;gap:10px}
.sp{width:28px;height:28px;border:3px solid #E5E7EB;border-top-color:#2563EB;border-radius:50%;animation:spin .8s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}
</style>
</head>
<body>
<div id="root"><div class="ld"><div class="sp"></div><span>Laden...</span></div></div>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
<script>
firebase.initializeApp({apiKey:"AIzaSyBQmM0NrGOC9od2nhWOpFaS2u7XFB1fVb8",authDomain:"maxi-orga.firebaseapp.com",projectId:"maxi-orga",storageBucket:"maxi-orga.firebasestorage.app",messagingSenderId:"446112436224",appId:"1:446112436224:web:797b842a4e9f2ec0a788e5"});
const db=firebase.firestore();db.enablePersistence({synchronizeTabs:true}).catch(()=>{});
</script>
<script type="text/babel">
const{useState,useEffect,useCallback,useMemo,useRef}=React;
const P={SANDER:"Sander",NATA:"Nata",BOTH:"Beide",NANNY:"Nanny"};
const OC={SANDER:["#DBEAFE","#1D4ED8"],NATA:["#FCE7F3","#BE185D"],BOTH:["#E0E7FF","#4338CA"],NANNY:["#FEF3C7","#D97706"]};
const FL={daily:"T√§glich",weekly:"W√∂chentl.",monthly:"Monatl.",bimonthly:"2-3 Mon.",quarterly:"Quartal",asneeded:"Bei Bedarf",ongoing:"Laufend",setup:"Setup"};
const FC={daily:"#DC2626",weekly:"#E8A317",monthly:"#2563EB",bimonthly:"#7C3AED",quarterly:"#4F46E5",asneeded:"#6B7280",ongoing:"#059669",setup:"#DB2777"};
const CL=[
{id:"daily",t:"T√§gliches",i:"‚òÄÔ∏è",c:"#E8A317"},{id:"kita",t:"Kita",i:"üè´",c:"#2563EB"},
{id:"health",t:"Krankheit",i:"üè•",c:"#DC2626"},{id:"clothing",t:"Kleidung",i:"üëï",c:"#7C3AED"},
{id:"food",t:"Ern√§hrung",i:"üçΩÔ∏è",c:"#059669"},{id:"dev",t:"Entwicklung",i:"üå±",c:"#0891B2"},
{id:"admin",t:"Admin",i:"üìã",c:"#EA580C"},{id:"nanny",t:"Nanny",i:"üë©‚Äçüë¶",c:"#DB2777"},
{id:"partner",t:"Partnerschaft",i:"üíë",c:"#4F46E5"}];
const DT=[
{id:"d1",x:"Wickeltasche packen",f:"daily",o:"NATA",tm:"morning",ct:"daily"},
{id:"d2",x:"Kita-Tasche vorbereiten",f:"daily",o:"SANDER",tm:"morning",ct:"daily"},
{id:"d3",x:"Kleidung wettergerecht",f:"daily",o:"NATA",tm:"morning",ct:"daily"},
{id:"d4",x:"Wer bringt? Wer holt?",f:"daily",o:"BOTH",tm:"morning",ct:"daily"},
{id:"d5",x:"Brotdose packen",f:"daily",o:"NATA",tm:"morning",ct:"daily"},
{id:"d6",x:"Abendroutine",f:"daily",o:"BOTH",tm:"evening",ct:"daily"},
{id:"d7",x:"Nachts reagieren",f:"daily",o:"BOTH",tm:"evening",ct:"daily"},
{id:"d8",x:"W√§sche",f:"weekly",o:"SANDER",ct:"daily"},
{id:"d9",x:"Kinderzimmer aufr√§umen",f:"weekly",o:"BOTH",ct:"daily"},
{id:"d10",x:"Spielzeug rotieren",f:"monthly",o:"NATA",ct:"daily"},
{id:"d11",x:"Entwicklung dokumentieren",f:"weekly",o:"BOTH",ct:"daily"},
{id:"k1",x:"Bring-/Abholzeiten",f:"setup",o:"BOTH",ct:"kita"},
{id:"k2",x:"Wechselplan",f:"weekly",o:"BOTH",ct:"kita"},
{id:"k4",x:"Wechselkleidung pr√ºfen",f:"weekly",o:"NATA",ct:"kita"},
{id:"k5",x:"Matschkleidung pr√ºfen",f:"weekly",o:"SANDER",ct:"kita"},
{id:"k6",x:"Hausschuhe ersetzen",f:"monthly",o:"NATA",ct:"kita"},
{id:"k7",x:"Elterninfos lesen",f:"daily",o:"BOTH",ct:"kita"},
{id:"k8",x:"Elternabende",f:"quarterly",o:"BOTH",ct:"kita"},
{id:"k9",x:"Entwicklungsgespr√§che",f:"quarterly",o:"BOTH",ct:"kita"},
{id:"k10",x:"Schlie√üzeiten blocken",f:"quarterly",o:"SANDER",ct:"kita"},
{id:"k11",x:"Urlaub anpassen",f:"quarterly",o:"BOTH",ct:"kita"},
{id:"h1",x:"Kranktag: wer bleibt?",f:"asneeded",o:"BOTH",ct:"health"},
{id:"h2",x:"Backup kl√§ren",f:"setup",o:"SANDER",ct:"health"},
{id:"h3",x:"Fiebernacht",f:"asneeded",o:"BOTH",ct:"health"},
{id:"h4",x:"Arzttermin",f:"asneeded",o:"BOTH",ct:"health"},
{id:"h5",x:"Krankschreibung",f:"asneeded",o:"BOTH",ct:"health"},
{id:"h6",x:"Medikamente besorgen",f:"asneeded",o:"SANDER",ct:"health"},
{id:"h7",x:"Kita-Wiedereinstieg",f:"asneeded",o:"NATA",ct:"health"},
{id:"c1",x:"Gr√∂√üe pr√ºfen",f:"bimonthly",o:"NATA",ct:"clothing"},
{id:"c2",x:"Saisonwechsel",f:"bimonthly",o:"NATA",ct:"clothing"},
{id:"c3",x:"Schuhe kaufen",f:"bimonthly",o:"SANDER",ct:"clothing"},
{id:"c4",x:"Regenausstattung",f:"bimonthly",o:"SANDER",ct:"clothing"},
{id:"c5",x:"Schlafsack anpassen",f:"bimonthly",o:"NATA",ct:"clothing"},
{id:"c6",x:"Kleine Kleidung aussortieren",f:"bimonthly",o:"NATA",ct:"clothing"},
{id:"c7",x:"Bodys auff√ºllen",f:"bimonthly",o:"SANDER",ct:"clothing"},
{id:"f1",x:"Kita-Essen checken",f:"daily",o:"NATA",ct:"food"},
{id:"f2",x:"Snackvorrat",f:"weekly",o:"SANDER",ct:"food"},
{id:"f3",x:"Trinkflasche reinigen",f:"daily",o:"BOTH",ct:"food"},
{id:"f4",x:"Abendessen planen",f:"weekly",o:"NATA",ct:"food"},
{id:"f5",x:"Lieblingsessen kennen",f:"ongoing",o:"BOTH",ct:"food"},
{id:"f6",x:"Neue Phasen tragen",f:"ongoing",o:"BOTH",ct:"food"},
{id:"e1",x:"Sprache beobachten",f:"ongoing",o:"BOTH",ct:"dev"},
{id:"e2",x:"B√ºcher austauschen",f:"monthly",o:"NATA",ct:"dev"},
{id:"e3",x:"Kurse organisieren",f:"monthly",o:"SANDER",ct:"dev"},
{id:"e4",x:"Spielzeug anpassen",f:"monthly",o:"NATA",ct:"dev"},
{id:"e5",x:"Geburtstage",f:"asneeded",o:"BOTH",ct:"dev"},
{id:"e6",x:"Soziale Kontakte",f:"weekly",o:"BOTH",ct:"dev"},
{id:"a1",x:"Kita-Beitr√§ge",f:"monthly",o:"SANDER",ct:"admin"},
{id:"a2",x:"Steuern",f:"quarterly",o:"SANDER",ct:"admin"},
{id:"a3",x:"Versicherungen",f:"quarterly",o:"SANDER",ct:"admin"},
{id:"a4",x:"Sparpl√§ne",f:"quarterly",o:"SANDER",ct:"admin"},
{id:"a5",x:"Reisepass",f:"asneeded",o:"NATA",ct:"admin"},
{id:"a6",x:"U-Untersuchungen",f:"quarterly",o:"NATA",ct:"admin"},
{id:"a7",x:"Zahnarztstart",f:"setup",o:"NATA",ct:"admin"},
{id:"n1",x:"Nanny-Verf√ºgbarkeit",f:"setup",o:"BOTH",ct:"nanny"},
{id:"n2",x:"Nanny anrufen",f:"setup",o:"SANDER",ct:"nanny"},
{id:"n3",x:"Stunden koordinieren",f:"weekly",o:"SANDER",ct:"nanny"},
{id:"n4",x:"Bezahlung",f:"monthly",o:"SANDER",ct:"nanny"},
{id:"n5",x:"√úbergabeinfos",f:"daily",o:"NATA",tm:"afternoon",ct:"nanny"},
{id:"p1",x:"Mental Load Check-in",f:"weekly",o:"BOTH",ct:"partner"},
{id:"p2",x:"Geschenke",f:"asneeded",o:"NATA",ct:"partner"},
{id:"p3",x:"Neue Schuhe n√∂tig?",f:"ongoing",o:"NATA",ct:"partner"},
{id:"p4",x:"Passt alles?",f:"ongoing",o:"BOTH",ct:"partner"}];
const DN=["So","Mo","Di","Mi","Do","Fr","Sa"];
const dky=d=>`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}-${String(d.getDate()).padStart(2,"0")}`;
const wky=d=>{const j=new Date(d.getFullYear(),0,1);return`${d.getFullYear()}-W${Math.ceil(((d-j)/864e5+j.getDay()+1)/7)}`};
const mky=d=>`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}`;
const tod=()=>{const h=new Date().getHours();return h<8?"morning":h<14?"midday":h<17?"afternoon":"evening"};
const nuid=()=>"t"+Date.now().toString(36)+Math.random().toString(36).slice(2,6);
const fmtT=ts=>{if(!ts)return"";return new Date(ts).toLocaleString("de-DE",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})};
const g7=()=>{const r=[];const t=new Date();for(let i=-1;i<7;i++){const d=new Date(t);d.setDate(t.getDate()+i);r.push(d)}return r};
function MI({onSend,ph}){const[v,sv]=useState("");const ref=useRef();
return(<div className="mib"><input ref={ref} value={v} onChange={e=>sv(e.target.value)} placeholder={ph||"Nachricht..."} onKeyDown={e=>{if(e.key==="Enter"&&v.trim()){onSend(v.trim());sv("")}}}/><button onClick={()=>{if(v.trim()){onSend(v.trim());sv("");ref.current?.focus()}}}>‚Üë</button></div>)}

function App(){
const[vw,setVw]=useState("today");
const[ts,setTs]=useState({});
const[tl,setTl]=useState(DT);
const[dOw,setDOw]=useState({});
const[bOw,setBOw]=useState({});
const[msgs,setMsgs]=useState({});
const[rdM,setRdM]=useState(()=>{try{return JSON.parse(localStorage.getItem("lr")||"{}")}catch{return{}}});
const[sDay,setSDay]=useState(new Date());
const[sCat,setSCat]=useState(null);
const[fp,setFp]=useState("SANDER");
const[cu,setCu]=useState(()=>localStorage.getItem("lu")||null);
const[shOb,setShOb]=useState(()=>!localStorage.getItem("lu"));
const[tOD]=useState(tod);
const[onl,setOnl]=useState(true);
const[ld,setLd]=useState(false);
const[modal,setMod]=useState(null);
const[search,setSrch]=useState("");
const[fd,setFd]=useState({});
const[cCat,setCCat]=useState(null);
const[cTask,setCTask]=useState(null);
const sk=useRef(false);
const days=useMemo(g7,[]);

useEffect(()=>{
const u=[];
u.push(db.collection("v2").doc("ts").onSnapshot(d=>{if(d.exists){sk.current=true;setTs(d.data());setTimeout(()=>sk.current=false,150)}setLd(true)}));
u.push(db.collection("v2").doc("tl").onSnapshot(d=>{if(d.exists&&d.data().l){sk.current=true;setTl(d.data().l);setTimeout(()=>sk.current=false,150)}}));
u.push(db.collection("v2").doc("dOw").onSnapshot(d=>{if(d.exists){sk.current=true;setDOw(d.data());setTimeout(()=>sk.current=false,150)}}));
u.push(db.collection("v2").doc("bOw").onSnapshot(d=>{if(d.exists){sk.current=true;setBOw(d.data());setTimeout(()=>sk.current=false,150)}}));
u.push(db.collection("v2").doc("msgs").onSnapshot(d=>{if(d.exists){sk.current=true;setMsgs(d.data());setTimeout(()=>sk.current=false,150)}}));
window.addEventListener("online",()=>setOnl(true));window.addEventListener("offline",()=>setOnl(false));
return()=>u.forEach(x=>x());
},[]);

useEffect(()=>{const i={};let c=false;tl.forEach(t=>{if(!bOw[t.id]){i[t.id]=t.o;c=true}});if(c)setBOw(p=>({...i,...p}))},[tl]);

const sv2=(doc,data)=>{if(!ld||sk.current)return;db.collection("v2").doc(doc).set(data)};
useEffect(()=>{if(!ld||sk.current)return;const t=setTimeout(()=>sv2("ts",ts),300);return()=>clearTimeout(t)},[ts,ld]);
useEffect(()=>{if(!ld||sk.current)return;const t=setTimeout(()=>sv2("tl",{l:tl}),300);return()=>clearTimeout(t)},[tl,ld]);
useEffect(()=>{if(!ld||sk.current)return;const t=setTimeout(()=>sv2("dOw",dOw),300);return()=>clearTimeout(t)},[dOw,ld]);
useEffect(()=>{if(!ld||sk.current)return;const t=setTimeout(()=>sv2("bOw",bOw),300);return()=>clearTimeout(t)},[bOw,ld]);
useEffect(()=>{if(!ld||sk.current)return;const t=setTimeout(()=>sv2("msgs",msgs),300);return()=>clearTimeout(t)},[msgs,ld]);
useEffect(()=>{localStorage.setItem("lr",JSON.stringify(rdM))},[rdM]);

const gOw=useCallback((tid,date)=>dOw[`${tid}_${dky(date)}`]||bOw[tid]||tl.find(t=>t.id===tid)?.o||"BOTH",[dOw,bOw,tl]);

const sOwn=useCallback((tid,per,scope,date)=>{
if(scope==="day"){setDOw(p=>({...p,[`${tid}_${dky(date)}`]:per}))}
else if(scope==="week"){const d=new Date(date);const dow=d.getDay();for(let i=0;i<7;i++){const nd=new Date(d);nd.setDate(d.getDate()-dow+i);setDOw(p=>({...p,[`${tid}_${dky(nd)}`]:per}))}}
else if(scope==="month"){const y=date.getFullYear(),m=date.getMonth();for(let i=1;i<=new Date(y,m+1,0).getDate();i++){const nd=new Date(y,m,i);setDOw(p=>({...p,[`${tid}_${dky(nd)}`]:per}))}}
else{setBOw(p=>({...p,[tid]:per}))}
},[]);

const ck=useCallback((tid,freq,date)=>{
if(freq==="daily")return`${tid}_${dky(date)}`;if(freq==="weekly")return`${tid}_${wky(date)}`;
if(freq==="monthly")return`${tid}_${mky(date)}`;return`${tid}_cur`;
},[]);
const isD=useCallback((tid,f,d)=>!!ts[ck(tid,f,d||sDay)],[ts,ck,sDay]);
const tog=useCallback((tid,f,d)=>{const k=ck(tid,f,d||sDay);setTs(p=>({...p,[k]:!p[k]}))},[ck,sDay]);

const addM=useCallback((key,text)=>{if(!text.trim())return;setMsgs(p=>{const a=p[key]?[...p[key]]:[];a.push({t:text.trim(),fr:cu,ts:Date.now()});return{...p,[key]:a}})},[cu]);
const mkRd=useCallback(key=>{const m=msgs[key]||[];if(m.length)setRdM(p=>({...p,[key]:m.length}))},[msgs]);

const cMap=useMemo(()=>{const m={};CL.forEach(c=>m[c.id]=c);return m},[]);
const tMap=useMemo(()=>{const m={};tl.forEach(t=>m[t.id]=t);return m},[tl]);

const dayT=useMemo(()=>{
const dow=sDay.getDay();
return tl.filter(t=>{
if(t.f==="daily")return true;if(t.f==="weekly"&&dow===1)return true;
if(t.f==="monthly"&&sDay.getDate()===1)return true;
if(["ongoing","asneeded","setup"].includes(t.f))return true;
if(t.f==="bimonthly"&&sDay.getDate()===1&&sDay.getMonth()%2===0)return true;
if(t.f==="quarterly"&&sDay.getDate()===1&&sDay.getMonth()%3===0)return true;
return false;
}).map(t=>({...t,cat:cMap[t.ct],owner:gOw(t.id,sDay)}));
},[tl,sDay,cMap,gOw]);

const sts=useMemo(()=>{
let tot=0,dn=0;const pp={SANDER:{t:0,d:0},NATA:{t:0,d:0},BOTH:{t:0,d:0}};
dayT.forEach(t=>{const c=isD(t.id,t.f,sDay);tot++;if(c)dn++;if(pp[t.owner]){pp[t.owner].t++;if(c)pp[t.owner].d++}});
return{tot,dn,pp};
},[dayT,isD,sDay]);

const sm=useMemo(()=>({m:dayT.filter(t=>t.tm==="morning"&&t.f==="daily"),a:dayT.filter(t=>t.tm==="afternoon"&&t.f==="daily"),e:dayT.filter(t=>t.tm==="evening"&&t.f==="daily"),d:dayT.filter(t=>t.f==="daily"&&!t.tm),o:dayT.filter(t=>t.f!=="daily")}),[dayT]);

const uCnt=useMemo(()=>{let c=0;Object.entries(msgs).forEach(([k,m])=>{if(!Array.isArray(m))return;const r=rdM[k]||0;m.slice(r).forEach(x=>{if(x.fr!==cu)c++})});return c},[msgs,rdM,cu]);

const savT=data=>{if(data.id){setTl(p=>p.map(t=>t.id===data.id?{...t,...data}:t));if(data.o)setBOw(p=>({...p,[data.id]:data.o}))}else{const n={...data,id:nuid()};setTl(p=>[...p,n]);setBOw(p=>({...p,[n.id]:n.o}))}setMod(null)};
const delT=id=>{setTl(p=>p.filter(t=>t.id!==id));setMod(null)};
// ONBOARDING
if(shOb)return(
<div className="ob"><div className="ob-l">üë∂</div><h1 className="ob-t">Liam Orga</h1><p className="ob-s">Organisation ¬∑ Care ¬∑ 50/50</p>
<div className="ob-c"><div className="ob-r"><span className="ob-i">üè´</span><div><span className="ob-lb">Kita ab M√§rz</span><br/><span className="ob-tm">8‚Äì15h ¬∑ Mo‚ÄìFr</span></div></div><div className="ob-r"><span className="ob-i">üë©‚Äçüë¶</span><div><span className="ob-lb">Nanny</span><br/><span className="ob-tm">15‚Äì19h ¬∑ Mo‚ÄìDo</span></div></div></div>
<div className="ob-inf"><strong>Echtzeit-Sync</strong> ‚Äì Aufgaben pro Tag zuweisen, Nachrichten schicken.</div>
<div className="ob-ns"><div className="ob-nl">Wer bist du?</div><div className="ob-nb">
<button className="ob-nbtn" style={{borderColor:"#1D4ED8",backgroundColor:cu==="SANDER"?"#1D4ED8":"transparent",color:cu==="SANDER"?"#fff":"#1D4ED8"}} onClick={()=>setCu("SANDER")}>Sander</button>
<button className="ob-nbtn" style={{borderColor:"#BE185D",backgroundColor:cu==="NATA"?"#BE185D":"transparent",color:cu==="NATA"?"#fff":"#BE185D"}} onClick={()=>setCu("NATA")}>Nata</button>
</div></div><button className="ob-go" disabled={!cu} onClick={()=>{localStorage.setItem("lu",cu);setFp(cu);setShOb(false)}}>Los geht's ‚Üí</button></div>);

// COMPONENTS
const PB=({d,t,c="#2563EB",s="n"})=>{const p=t>0?Math.round(d/t*100):0;return(<div className="pr"><div className={`pr-bg ${s==="l"?"h5":s==="s"?"h3":""}`}><div className="pr-f" style={{width:`${p}%`,backgroundColor:c}}/></div><span className="pr-t">{p}%</span></div>)};

const TC=({t,showCat})=>{
const d=isD(t.id,t.f,sDay),ow=t.owner||gOw(t.id,sDay),oc=OC[ow]||OC.BOTH;
const mk=`${t.id}_${dky(sDay)}`;const mc=(msgs[t.id]||[]).length+(msgs[mk]||[]).length;
return(<div className={`tc ${d?"done":""}`}><div className="tc-r">
<button className={`ck ${d?"on":""}`} onClick={()=>tog(t.id,t.f,sDay)}>{d?"‚úì":""}</button>
<div className="tc-c"><div className="tc-t" style={d?{textDecoration:"line-through"}:{}}>{t.x}</div>
<div className="tc-m">{showCat&&t.cat&&<span style={{fontSize:10,fontWeight:600,color:t.cat.c}}>{t.cat.i}</span>}
<span className="bg" style={{backgroundColor:FC[t.f]+"18",color:FC[t.f]}}>{FL[t.f]}</span>
{mc>0&&<span style={{fontSize:9,color:"#94A3B8"}}>üí¨{mc}</span>}</div></div>
<button className="tc-ob" style={{borderColor:oc[1],color:oc[1],background:oc[0]}} onClick={()=>{setFd({tid:t.id,per:ow,scope:"day"});setMod({type:"assign"})}}>{P[ow]?.slice(0,1)}</button>
</div></div>)};

const TS=({title,icon,tasks})=>{if(!tasks.length)return null;
const dc=tasks.filter(t=>isD(t.id,t.f,sDay)).length,ad=dc===tasks.length;
return(<div className="tsec"><div className="tsec-h"><div className="tsec-t"><span>{icon}</span>{title}</div>
<span className={`tsec-c ${ad?"done":"pending"}`}>{dc}/{tasks.length}</span></div>
{ad&&tasks.length>0&&<div className="cel"><div className="cel-e">‚ú®</div><div className="cel-t">Erledigt!</div></div>}
{tasks.map(t=><TC key={t.id} t={t} showCat/>)}</div>)};

// DAY SELECTOR
const DaySel=()=>(<div className="days">{days.map(d=>{const k=dky(d);const act=k===dky(sDay);const isTd=k===dky(new Date());
return<button key={k} className={`day-btn ${act?"active":""} ${isTd&&!act?"td":""}`} onClick={()=>setSDay(new Date(d))}>
<span className="dn">{DN[d.getDay()]}</span><span className="dnum">{d.getDate()}</span></button>})}</div>);

// TODAY VIEW
const todayV=()=>{const dk=dky(sDay);const isT=dk===dky(new Date());
return(<div className="vp"><DaySel/>
{isT&&<div className="gc"><div className="gc-t">{tOD==="morning"?"Guten Morgen":tOD==="midday"?"Mahlzeit":tOD==="afternoon"?"Nachmittag":"Guten Abend"}, {P[cu]} üëã</div>
<div className="gc-s">{sts.dn}/{sts.tot} erledigt</div><PB d={sts.dn} t={sts.tot} s="l"/></div>}
{!isT&&<div className="gc"><div style={{fontSize:16,fontWeight:700,color:"#1E293B"}}>{sDay.toLocaleDateString("de-DE",{weekday:"long",day:"numeric",month:"long"})}</div>
<div className="gc-s">{sts.dn}/{sts.tot} erledigt</div><PB d={sts.dn} t={sts.tot} s="l"/></div>}
{isT&&<div className="sbar"><span>üè´ 8‚Äì15h</span><span className="ar">‚Üí</span><span>üë©‚Äçüë¶ 15‚Äì19h</span><span className="ar">‚Üí</span><span>üè† Abend</span></div>}
<TS title="Morgens" icon="üåÖ" tasks={sm.m}/><TS title="Nanny-√úbergabe" icon="üîÑ" tasks={sm.a}/>
<TS title="Abends" icon="üåô" tasks={sm.e}/><TS title="Laufend" icon="üìã" tasks={sm.d}/>
{sm.o.length>0&&<TS title="Sonstige" icon="üìå" tasks={sm.o}/>}
<div className="mlc"><div className="ml-t">‚öñÔ∏è Balance</div><div className="ml-s">{[["SANDER","#1D4ED8"],["BOTH","#4338CA"],["NATA","#BE185D"]].map(([p,c])=>{const s=sts.pp[p]||{t:0,d:0};return<div key={p} className="ml-si"><div className="ml-n" style={{color:c}}>{s.t}</div><div className="ml-l">{P[p]}</div></div>})}</div></div>
</div>)};

// PERSON VIEW
const personV=()=>{
const p=fp,ta=dayT.filter(t=>t.owner===p||t.owner==="BOTH"),pd=ta.filter(t=>isD(t.id,t.f,sDay)).length,pc=p==="SANDER"?"#1D4ED8":"#BE185D";
const g={};ta.forEach(t=>{if(!g[t.ct])g[t.ct]={cat:cMap[t.ct],tasks:[]};g[t.ct].tasks.push(t)});
return(<div className="vp"><DaySel/>
<div className="ptabs">{["SANDER","NATA"].map(pp=>{const a=p===pp,c=pp==="SANDER"?"#1D4ED8":"#BE185D";return<button key={pp} className="ptab" style={{borderColor:c,backgroundColor:a?c:"transparent",color:a?"#fff":c}} onClick={()=>setFp(pp)}>{P[pp]}</button>})}</div>
<div className="mlc" style={{borderLeft:`3px solid ${pc}`}}><div style={{fontSize:16,fontWeight:800,color:"#1E293B"}}>{P[p]}s Aufgaben</div>
<div style={{fontSize:12,color:"#94A3B8",margin:"3px 0 6px"}}>{pd}/{ta.length} erledigt</div><PB d={pd} t={ta.length} c={pc}/></div>
{Object.values(g).filter(x=>x.cat).map(({cat,tasks:ct})=>{const un=ct.filter(t=>!isD(t.id,t.f,sDay)),dn2=ct.filter(t=>isD(t.id,t.f,sDay));
return<div key={cat.id}><div className="pch" style={{color:cat.c}}>{cat.i} {cat.t}<span className="pcc">{dn2.length}/{ct.length}</span></div>
{un.map(t=><TC key={t.id} t={t}/>)}{dn2.map(t=><TC key={t.id} t={t}/>)}</div>})}
</div>)};
// CHAT VIEW - organized by categories
const chatV=()=>{
// Level 1: category list
if(!cCat&&!cTask){
const catMsgs={};
Object.entries(msgs).forEach(([k,m])=>{if(!Array.isArray(m)||!m.length)return;
const tid=k.split("_")[0];const task=tMap[tid];if(!task)return;
if(!catMsgs[task.ct])catMsgs[task.ct]={cnt:0,unread:0,last:0};
catMsgs[task.ct].cnt+=m.length;
const rd=rdM[k]||0;catMsgs[task.ct].unread+=m.slice(rd).filter(x=>x.fr!==cu).length;
const lt=m[m.length-1]?.ts||0;if(lt>catMsgs[task.ct].last)catMsgs[task.ct].last=lt;
});
return(<div className="vp">
<div style={{fontSize:16,fontWeight:700,color:"#1E293B",marginBottom:4}}>üí¨ Nachrichten</div>
<div style={{fontSize:11,color:"#94A3B8",marginBottom:12}}>W√§hle einen Bereich</div>
{CL.map(cat=>{const cm=catMsgs[cat.id];const tasks=tl.filter(t=>t.ct===cat.id);
return<button key={cat.id} className="ccb" onClick={()=>setCCat(cat.id)}>
<span className="cci">{cat.i}</span><span className="cct">{cat.t}</span>
<span className="ccn">{tasks.length} Aufgaben</span>
{cm&&cm.unread>0&&<span className="ubg">{cm.unread}</span>}
</button>})}
</div>)}

// Level 2: task list within category
if(cCat&&!cTask){
const cat=cMap[cCat];const tasks=tl.filter(t=>t.ct===cCat);
return(<div className="vp">
<button className="bk" onClick={()=>setCCat(null)}>‚Üê Bereiche</button>
<div style={{display:"flex",alignItems:"center",gap:8,marginBottom:12}}>
<span style={{fontSize:24}}>{cat?.i}</span><div><div style={{fontSize:15,fontWeight:700,color:"#1E293B"}}>{cat?.t}</div>
<div style={{fontSize:11,color:"#94A3B8"}}>{tasks.length} Aufgaben</div></div></div>
{tasks.map(t=>{const mk1=t.id;const mk2=`${t.id}_${dky(sDay)}`;
const m1=msgs[mk1]||[];const m2=msgs[mk2]||[];const allM=[...m1,...m2].sort((a,b)=>a.ts-b.ts);
const rd1=rdM[mk1]||0;const rd2=rdM[mk2]||0;
const unread=m1.slice(rd1).filter(x=>x.fr!==cu).length+m2.slice(rd2).filter(x=>x.fr!==cu).length;
const last=allM[allM.length-1];
return<button key={t.id} className="ctb" onClick={()=>setCTask(t.id)}>
{unread>0&&<span className="udot"/>}
<span className="ctt">{t.x}</span>
{last&&<span className="ctl">{last.t}</span>}
{unread>0&&<span className="ubg">{unread}</span>}
</button>})}
</div>)}

// Level 3: thread for specific task
if(cTask){
const t=tMap[cTask];const cat=cMap[t?.ct];
const mk1=cTask;const mk2=`${cTask}_${dky(sDay)}`;
const m1=(msgs[mk1]||[]).map(m=>({...m,ctx:"allgemein"}));
const m2=(msgs[mk2]||[]).map(m=>({...m,ctx:dky(sDay)}));
const allM=[...m1,...m2].sort((a,b)=>a.ts-b.ts);
mkRd(mk1);mkRd(mk2);
return(<div style={{display:"flex",flexDirection:"column",height:"100%"}}>
<div className="th"><button className="th-bk" onClick={()=>setCTask(null)}>‚Üê</button>
<div style={{flex:1}}><div className="th-t">{t?.x||"?"}</div><div className="th-s">{cat?.i} {cat?.t}</div></div></div>
<div className="tmsgs">
{allM.length===0&&<div style={{textAlign:"center",padding:40,color:"#94A3B8",fontSize:13}}>Noch keine Nachrichten</div>}
{allM.map((m,i)=><div key={i} className={`mb ${m.fr===cu?"mine":"theirs"}`}>
<div>{m.t}</div><div className="mbi">{P[m.fr]} ¬∑ {fmtT(m.ts)}{m.ctx!=="allgemein"?" ¬∑ "+m.ctx:""}</div>
</div>)}
</div>
<div style={{padding:"6px 14px 2px",display:"flex",gap:"6px"}}>
<button style={{flex:1,padding:"6px 0",borderRadius:8,border:"1.5px solid "+(dky(sDay)===dky(new Date())?"#2563EB":"#E5E7EB"),background:dky(sDay)===dky(new Date())?"#EFF6FF":"#fff",fontSize:11,fontWeight:600,color:dky(sDay)===dky(new Date())?"#2563EB":"#94A3B8"}}
  onClick={()=>{}}>{sDay.toLocaleDateString("de-DE",{day:"numeric",month:"short"})}</button>
<button style={{flex:1,padding:"6px 0",borderRadius:8,border:"1.5px solid #E5E7EB",background:"#fff",fontSize:11,fontWeight:600,color:"#94A3B8"}}
  onClick={()=>{}}>Allgemein</button>
</div>
<MI onSend={text=>addM(mk2,text)} ph={`Nachricht f√ºr ${sDay.toLocaleDateString("de-DE",{day:"numeric",month:"short"})}...`}/>
</div>)}
return null;
};
// LIBRARY VIEW
const libV=()=>{
const filtered=search?tl.filter(t=>t.x.toLowerCase().includes(search.toLowerCase())):tl;
const grouped={};filtered.forEach(t=>{if(!grouped[t.ct])grouped[t.ct]={cat:cMap[t.ct],tasks:[]};grouped[t.ct].tasks.push(t)});
return(<div className="vp">
<div className="lh"><div className="lt">üìö Library</div>
<button className="la" onClick={()=>{setFd({x:"",detail:"",f:"daily",o:"BOTH",ct:"daily",tm:""});setMod({type:"new"})}}>Ôºã Neu</button></div>
<input className="ls" placeholder="üîç Suchen..." value={search} onChange={e=>setSrch(e.target.value)}/>
<div style={{fontSize:11,color:"#94A3B8",marginBottom:10,fontWeight:600}}>{filtered.length} Aufgaben</div>
{Object.values(grouped).filter(x=>x.cat).map(({cat,tasks:ct})=>(
<div key={cat.id}>
<div style={{display:"flex",alignItems:"center",gap:5,padding:"8px 0 3px",fontSize:12,fontWeight:700,color:cat.c}}>{cat.i} {cat.t} <span style={{fontSize:10,color:"#94A3B8"}}>({ct.length})</span></div>
{ct.map(t=>{const ow=bOw[t.id]||t.o;return(
<div key={t.id} className="li"><div className="li-c"><div className="li-t">{t.x}</div>
<div className="li-m"><span className="bg" style={{backgroundColor:FC[t.f]+"18",color:FC[t.f]}}>{FL[t.f]}</span>
<span className="bg" style={{backgroundColor:(OC[ow]||OC.BOTH)[0],color:(OC[ow]||OC.BOTH)[1],marginLeft:3}}>{P[ow]}</span></div></div>
<div className="li-a">
<button className="lib" onClick={()=>{setFd({id:t.id,x:t.x,detail:t.detail||"",f:t.f,o:ow,ct:t.ct,tm:t.tm||""});setMod({type:"edit"})}}>‚úèÔ∏è</button>
<button className="lib libd" onClick={()=>{if(confirm(`"${t.x}" l√∂schen?`))delT(t.id)}}>üóë</button>
</div></div>)})}
</div>))}
</div>)};

// CHECK-IN VIEW
const chkV=()=>(<div className="vp"><div className="cic"><div className="ci-t">‚öñÔ∏è Check-in</div><div className="ci-s">Geht diese Fragen zusammen durch:</div>
{["Wer hat mehr Mental Load getragen?","Aufgaben umverteilen?","Nanny-Management 50/50?","Kita-Absprachen klar?","Was hat geklappt?","Was braucht ihr?"].map((q,i)=>
<div key={i} className="ci-q"><span className="ci-n">{i+1}</span><span className="ci-tx">{q}</span></div>)}
<div className="tb y"><div className="tbt">üîÑ Umverteilen</div><div className="tbx">In der Library Aufgaben anpassen.</div></div>
<div className="tb g"><div className="tbt">üí° Tipp</div><div className="tbx">Nanny-Management auch 50/50.</div></div></div></div>);

// ASSIGN MODAL
const assignMod=()=>{if(!modal||modal.type!=="assign")return null;
const t=tMap[fd.tid];if(!t)return null;
return(<div className="mo" onClick={e=>{if(e.target===e.currentTarget)setMod(null)}}><div className="md">
<div className="md-t"><span>üë§ {t.x}</span><button className="md-x" onClick={()=>setMod(null)}>‚úï</button></div>
<div style={{fontSize:14,fontWeight:700,color:"#1E293B",marginBottom:10}}>Wer √ºbernimmt?</div>
<div className="asp">{["SANDER","NATA","BOTH"].map(p=>{const a=fd.per===p;const c=OC[p];
return<button key={p} className="aspp" style={{borderColor:a?c[1]:"#E5E7EB",backgroundColor:a?c[0]:"#fff",color:a?c[1]:"#94A3B8"}} onClick={()=>setFd(x=>({...x,per:p}))}>{P[p]}</button>})}</div>
<div style={{fontSize:14,fontWeight:700,color:"#1E293B",marginBottom:10}}>F√ºr wie lange?</div>
<div className="asc">
{[["day","Nur diesen Tag",sDay.toLocaleDateString("de-DE",{day:"numeric",month:"short"})],
["week","Diese Woche","Mo‚ÄìSo"],
["month","Diesen Monat",sDay.toLocaleString("de-DE",{month:"long"})],
["forever","Immer","Standard √§ndern"]].map(([s,l,h])=>
<button key={s} className={`asb ${fd.scope===s?"sel":""}`} onClick={()=>setFd(x=>({...x,scope:s}))}>{l}<span className="ash">{h}</span></button>)}
</div>
<button className="assv" onClick={()=>{sOwn(fd.tid,fd.per,fd.scope,sDay);setMod(null)}}>Speichern</button>
</div></div>)};

// EDIT/NEW MODAL
const editMod=()=>{if(!modal||!["edit","new"].includes(modal.type))return null;const isE=modal.type==="edit";
return(<div className="mo" onClick={e=>{if(e.target===e.currentTarget)setMod(null)}}><div className="md">
<div className="md-t"><span>{isE?"‚úèÔ∏è Bearbeiten":"Ôºã Neue Aufgabe"}</span><button className="md-x" onClick={()=>setMod(null)}>‚úï</button></div>
<div className="fg"><label className="fl">Aufgabe</label><input className="fi" value={fd.x||""} onChange={e=>setFd(p=>({...p,x:e.target.value}))} placeholder="Was?"/></div>
<div className="fg"><label className="fl">Details</label><textarea className="fta" value={fd.detail||""} onChange={e=>setFd(p=>({...p,detail:e.target.value}))} placeholder="Optional..."/></div>
<div className="fr">
<div className="fg" style={{flex:1}}><label className="fl">Bereich</label><select className="fse" value={fd.ct||"daily"} onChange={e=>setFd(p=>({...p,ct:e.target.value}))}>
{CL.map(c=><option key={c.id} value={c.id}>{c.i} {c.t}</option>)}</select></div>
<div className="fg" style={{flex:1}}><label className="fl">Frequenz</label><select className="fse" value={fd.f||"daily"} onChange={e=>setFd(p=>({...p,f:e.target.value}))}>
{Object.entries(FL).map(([k,v])=><option key={k} value={k}>{v}</option>)}</select></div></div>
<div className="fr">
<div className="fg" style={{flex:1}}><label className="fl">Zust√§ndig</label><select className="fse" value={fd.o||"BOTH"} onChange={e=>setFd(p=>({...p,o:e.target.value}))}>
{Object.entries(P).map(([k,v])=><option key={k} value={k}>{v}</option>)}</select></div>
<div className="fg" style={{flex:1}}><label className="fl">Tageszeit</label><select className="fse" value={fd.tm||""} onChange={e=>setFd(p=>({...p,tm:e.target.value}))}>
<option value="">Keine</option><option value="morning">Morgens</option><option value="afternoon">Nachmittags</option><option value="evening">Abends</option></select></div></div>
<button className="fsub" onClick={()=>{if(!fd.x?.trim())return;savT(fd)}}>{isE?"Speichern":"Hinzuf√ºgen"}</button>
{isE&&<button className="fdel" onClick={()=>{if(confirm("L√∂schen?"))delT(fd.id)}}>üóë L√∂schen</button>}
</div></div>)};

// NAV + RENDER
const navI=[{id:"today",i:"üè†",l:"Heute"},{id:"person",i:"üë§",l:"Meine"},{id:"chat",i:"üí¨",l:"Chat"},{id:"lib",i:"üìö",l:"Library"},{id:"chk",i:"‚öñÔ∏è",l:"Check-in"}];
return(<div className="app">
<div className="hdr"><div className="hdr-l"><span className="hdr-e">üë∂</span><div><div className="hdr-t">Liam Orga</div><div className="hdr-d">{new Date().toLocaleDateString("de-DE",{weekday:"short",day:"numeric",month:"short"})}</div></div></div>
<div className="hdr-r"><div className={`sdot ${onl?"on":"off"}`}/><div className="hdr-s">{sts.dn}/{sts.tot} ‚úì</div></div></div>
<div className="cnt">
{vw==="today"&&todayV()}
{vw==="person"&&personV()}
{vw==="chat"&&chatV()}
{vw==="lib"&&libV()}
{vw==="chk"&&chkV()}
</div>
{assignMod()}{editMod()}
<div className="nav">{navI.map(n=><button key={n.id} className={`nb ${vw===n.id?"act":""}`} onClick={()=>{setVw(n.id);if(n.id==="chat"){setCCat(null);setCTask(null)}}}>
<span className="ni">{n.i}</span><span className="nl">{n.l}</span>
{n.id==="chat"&&uCnt>0&&<span className="nbg">{uCnt}</span>}
</button>)}</div>
</div>);
}
ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
</script>
</body>
</html>
